Loaded 260 samples from reviewFeatures.csv
Class distribution  → Real: 130  Fake: 130

Step 0  – Data split
  Train+Val : 208  (Real=104, Fake=104)
  Test      : 52  (Real=26, Fake=26)

Step 1  – 5-Fold Stratified CV  (verifying stratification)
  Fold   Train Real Train Fake Train %Real  │  Val Real Val Fake Val %Real
  ------------------------------------------------------------------------
  1              83         83       50.0%  │        21       21     50.0%
  2              83         83       50.0%  │        21       21     50.0%
  3              83         83       50.0%  │        21       21     50.0%
  4              84         83       50.3%  │        20       21     48.8%
  5              83         84       49.7%  │        21       20     51.2%
  Overall class ratio: 50.0% Real

>>> Tuning: RandomForest (no FS)  (300 Optuna trials) …
    [No FS]  CV-F1=0.6280  Train-Acc=0.7837  Test-Acc=0.7692  Test-F1=0.7692  feats=10

>>> Tuning: RandomForest (FS)  (300 Optuna trials) …
    [With FS]  CV-F1=0.6528  Train-Acc=0.8173  Test-Acc=0.7115  Test-F1=0.7059  feats=5

=================================================================
  RandomForest – No FS
=================================================================
  Best CV F1 (mean) : 0.6280
  Best Optuna params: {'n_estimators': 50, 'max_depth': 5, 'min_samples_split': 7, 'min_samples_leaf': 9, 'max_features': 'sqrt'}

  ── Train-set results ──
  Accuracy : 0.7837

  ── Test-set results ──
  Accuracy : 0.7692
  F1-score : 0.7692
  Features : 10

  Confusion Matrix:
[[20  6]
 [ 6 20]]

              precision    recall  f1-score   support

        Fake       0.77      0.77      0.77        26
        Real       0.77      0.77      0.77        26

    accuracy                           0.77        52
   macro avg       0.77      0.77      0.77        52
weighted avg       0.77      0.77      0.77        52

  Feature importance ranking:
    1.  NAJ  →  0.2152
    2.  NWO  →  0.1830
    3.  AWL  →  0.1737
    4.  ASL  →  0.1181
    5.  NVB  →  0.1058
    6.  NST  →  0.0872
    7.  CDV  →  0.0524
    8.  TPR  →  0.0408
    9.  NTP  →  0.0152
    10.  NPV  →  0.0086

=================================================================
  RandomForest – With FS
=================================================================
  Best CV F1 (mean) : 0.6528
  Best Optuna params: {'n_estimators': 50, 'max_depth': 15, 'min_samples_split': 9, 'min_samples_leaf': 6, 'max_features': 'sqrt', 'selector_k': 5, 'score_func': 'f_classif'}
  Selected features : ['AWL', 'NWO', 'NVB', 'NAJ', 'NST']

  ── Train-set results ──
  Accuracy : 0.8173

  ── Test-set results ──
  Accuracy : 0.7115
  F1-score : 0.7059
  Features : 5

  Confusion Matrix:
[[19  7]
 [ 8 18]]

              precision    recall  f1-score   support

        Fake       0.70      0.73      0.72        26
        Real       0.72      0.69      0.71        26

    accuracy                           0.71        52
   macro avg       0.71      0.71      0.71        52
weighted avg       0.71      0.71      0.71        52

  Feature importance ranking:
    1.  NWO  →  0.2441
    2.  AWL  →  0.2434
    3.  NAJ  →  0.2323
    4.  NVB  →  0.1558
    5.  NST  →  0.1243

  Model saved → /Users/lawrencechen/Downloads/CS273-HW2/Review Forest Model/best_model_no_fs.joblib
  Model saved → /Users/lawrencechen/Downloads/CS273-HW2/Review Forest Model/best_model_with_fs.joblib

=================================================================
  SUMMARY COMPARISON
=================================================================
Metric                                No FS        With FS
----------------------------------------------------------
Model                          RandomForest   RandomForest
Train Accuracy                       0.7837         0.8173
Test Accuracy                        0.7692         0.7115
F1-score (main metric)               0.7692         0.7059
# Selected features                      10              5
Most important feature                  NAJ            NWO
----------------------------------------------------------

  → Overall winner (by F1): RandomForest (no feature selection)  F1 = 0.7692


>>> Generating plots → /Users/lawrencechen/Downloads/CS273-HW2/Review Forest Model/plots
  Saved: /Users/lawrencechen/Downloads/CS273-HW2/Review Forest Model/plots/RandomForest_confusion_matrices.png
  Saved: /Users/lawrencechen/Downloads/CS273-HW2/Review Forest Model/plots/RandomForest_feature_importance.png
  Saved: /Users/lawrencechen/Downloads/CS273-HW2/Review Forest Model/plots/RandomForest_performance.png

  Total PNGs: 4